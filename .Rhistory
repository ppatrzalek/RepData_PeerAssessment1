```{r echo = TRUE}
```{r echo = TRUE}
library(readr)
data <- read_csv("activity.zip")
summary(data)
head(data)
str(data)
Percentage_NA <- length(which(is.na(data$steps)))/length(data$steps)
print(Percentage_NA)
summary(data)
dim(data)
mean(data$steps, na.rm = TRUE)
summarise(mean_perday = mean(step, na.rm = TRUE))
library(dplyr)
data %>%
data %>%
data
data
head(data)
mean_perday <- data %>%
print(Percentage_NA)
mean_perday <- data %>%
group_by(date) %>%
summarise(sum_perday = sum(steps, na.rm = TRUE))
mean_perday
mean_perday <- data %>%
mean_perday
mean_perday <- data %>%
mean_perday
data %>%
group_by(date) %>%
mutate(sum_perday = sum(steps, na.rm = TRUE)) %>%
mean(sum_perday, na.rm = TRUE)
data %>%
group_by(date) %>%
mutate(sum_perday = sum(steps, na.rm = TRUE)) %>%
summarise(mean_perday = mean(sum_perday, na.rm = TRUE))
data %>%
group_by(date) %>%
mutate(sum_perday = sum(steps, na.rm = TRUE)) %>%
summarise(mean_perday = mean(sum_perday, na.rm = TRUE))
mean_perday <- data %>%
mean_perday <- data %>%
group_by(date) %>%
mutate(sum_perday = sum(steps, na.rm = TRUE)) %>%
summarize(mean_perday = mean(sum_perday, na.rm = TRUE))
mean_perday <- data %>%
group_by(date) %>%
mutate(sum_perday = sum(steps, na.rm = TRUE)) %>%
summarize(mean_perday = mean(sum_perday, na.rm = TRUE))
mean_perday
sum_perday <- data %>%
sum_perday <- data %>%
group_by(date) %>%
summarise(sum_perday = sum(steps, na.rm = TRUE))
sum_perday <- data %>%
group_by(date) %>%
summarise(sum_perday = sum(steps, na.rm = TRUE))
summarize(sum_perday, mean_perday = mean(sum_perday, na.rm = TRUE))
View(sum_perday)
mean(sum_perday$sum_perday, na.rm = TRUE)
filter(data, !is.na(steps))
library(readr)
data <- read_csv("activity.zip")
library(dplyr)
sum_perday <- data %>%
group_by(date) %>%
summarise(sum_perday = sum(steps, na.rm = TRUE))
mean_steps <- summarize(sum_perday, mean_perday = round(mean(sum_perday, na.rm = TRUE), 2))
sum_perday
ggplot(data = sum_perday) +
geom_histogram(mapping = aes(x = sum_perday))
library(ggplot2)
ggplot(data = sum_perday) +
geom_histogram(mapping = aes(x = sum_perday))
mean_steps <- summarize(sum_perday,
mean_perday = round(mean(sum_perday, na.rm = TRUE), 2),
median_perday = roun(median(sum_perday, na.rm = TRUE), 2))
stat_steps <- summarize(sum_perday,
mean_perday = round(mean(sum_perday, na.rm = TRUE), 2),
median_perday = round(median(sum_perday, na.rm = TRUE), 2))
print(stat_steps)
ggplot(data = sum_perday) +
geom_histogram(mapping = aes(x = sum_perday), binwidth = 40)
ggplot(data = sum_perday) +
geom_histogram(mapping = aes(x = sum_perday), binwidth = 30)
ggplot(data = sum_perday) +
geom_histogram(mapping = aes(x = sum_perday), binwidth = 20)
ggplot(data = sum_perday) +
geom_histogram(mapping = aes(x = sum_perday), binwidth = 0)
ggplot(data = sum_perday) +
geom_histogram(mapping = aes(x = sum_perday), binwidth = 10)
ggplot(data = sum_perday) +
geom_histogram(mapping = aes(x = sum_perday))
ggplot(data = sum_perday) +
geom_histogram(mapping = aes(x = sum_perday)) +
stat_bin(bins = 30)
ggplot(data = sum_perday) +
geom_histogram(mapping = aes(x = sum_perday)) +
stat_bin(mapping = aes(x = sum_perday), bins = 30)
ggplot(data = sum_perday) +
geom_histogram(mapping = aes(x = sum_perday)) +
stat_bin(mapping = aes(x = sum_perday), bins = 40)
ggplot(data = sum_perday) +
geom_histogram(mapping = aes(x = sum_perday)) +
stat_bin(mapping = aes(x = sum_perday), bins = 100)
ggplot(data = sum_perday) +
geom_histogram(mapping = aes(x = sum_perday)) +
stat_bin(mapping = aes(x = sum_perday), bins = 10)
ggplot(data = sum_perday) +
geom_histogram(mapping = aes(x = sum_perday)) +
stat_bin(mapping = aes(x = sum_perday), bins = 20)
ggplot(data = sum_perday) +
# geom_histogram(mapping = aes(x = sum_perday)) +
stat_bin(mapping = aes(x = sum_perday), bins = 20)
ggplot(data = sum_perday) +
# geom_histogram(mapping = aes(x = sum_perday)) +
stat_bin(mapping = aes(x = sum_perday), bins = 30)
ggplot(data = sum_perday) +
geom_histogram(mapping = aes(x = sum_perday), ma.rm = TRUE, bins = 10) +
ggplot(data = sum_perday) +
geom_histogram(mapping = aes(x = sum_perday), na.rm = TRUE, bins = 10) +
ggplot(data = sum_perday) +
geom_histogram(mapping = aes(x = sum_perday), na.rm = TRUE, bins = 10) +
ggplot(data = sum_perday) +
geom_histogram(mapping = aes(x = sum_perday), na.rm = TRUE, bins = 10)
ggplot(data = sum_perday) +
geom_histogram(mapping = aes(x = sum_perday), na.rm = TRUE, bins = 10)
ggplot(data = sum_perday) +
geom_histogram(mapping = aes(x = sum_perday), na.rm = TRUE, bins = 30)
ggplot(data = sum_perday) +
geom_histogram(mapping = aes(x = sum_perday), na.rm = TRUE, bins = 30)
ggplot(data = sum_perday) +
geom_histogram(mapping = aes(x = sum_perday), na.rm = TRUE, bins = 30)
ggplot(data = sum_perday) +
geom_histogram(mapping = aes(x = sum_perday), na.rm = FALSE, bins = 30)
```{r echo = TRUE}
```{r echo = TRUE}
ggplot(data = sum_perday) +
geom_histogram(mapping = aes(x = sum_perday), na.rm = TRUE, bins = 30)
ggplot(data = sum_perday) +
geom_histogram(mapping = aes(x = sum_perday), na.rm = FALSE, bins = 30)
ggplot(data = sum_perday) +
geom_histogram(mapping = aes(x = sum_perday), bins = 40)
ggplot(data = sum_perday) +
geom_histogram(mapping = aes(x = sum_perday), bins = 30)
ggplot(data = sum_perday) +
geom_histogram(mapping = aes(x = sum_perday))
daily_activity <- data %>%
group_by(interval) %>%
summarise(mean_steps = mean(steps, na.rm = TRUE))
ggplot(data = daily_activity, mapping = aes(x = interval, y = mean_steps)) +
geom_line(colour = "red") +
labs(x = "Interval", y = "Average steps", title = "Average daily activity pattern") +
theme_bw()
NA_data <- length(is.na(data$steps))
print(NA_data)
data_NA <- length(is.na(data$steps))
Percentage_NA <- length(which(is.na(data$steps)))/length(data$steps)
print(c(data_NA, Percentage_NA))
print(list(data_NA, Percentage_NA))
data_imput <- data %>%
left_join(., daily_activity, by = c("interval")) %>%
transform(steps = ifelse(is.na(steps), round(mean_steps, 0), steps)) %>%
select(-mean_steps)
dim(data_imput); dim(data)
sum_perday_imput <- data_imput %>%
group_by(date) %>%
summarise(sum_perday_imput = sum(steps, na.rm = TRUE))
stat_steps_imput <- summarize(sum_perday_imput,
mean_perday_imput = round(mean(sum_perday, na.rm = TRUE), 2),
median_perday_imput = median(sum_perday, na.rm = TRUE))
stat_steps_imput <- summarize(sum_perday_imput,
mean_perday_imput = round(mean(sum_perday_imput, na.rm = TRUE), 2),
median_perday_imput = median(sum_perday_imput, na.rm = TRUE))
print(stat_steps_imput)
print(stat_steps_imput); print(stat_steps)
print(list(stat_steps_imput, stat_steps))
stat_steps_imput
stat_steps <- summarize(sum_perday,
mean_perday = round(mean(sum_perday, na.rm = TRUE), 2),
median_perday = median(sum_perday, na.rm = TRUE)) %>%
mutate(Name = "Original")
print(stat_steps)
stat_steps_imput <- summarize(sum_perday_imput,
mean_perday_imput = round(mean(sum_perday_imput, na.rm = TRUE), 2),
median_perday_imput = median(sum_perday_imput, na.rm = TRUE)) %>%
mutate(Name = "Imputation")
print(union(stat_steps, stat_steps_imput))
stat_steps_imput <- summarize(sum_perday_imput,
mean_perday = round(mean(sum_perday_imput, na.rm = TRUE), 2),
median_perday = median(sum_perday_imput, na.rm = TRUE)) %>%
mutate(Name = "Imputation")
print(union(stat_steps, stat_steps_imput))
ggplot(data = sum_perday_imput) +
geom_histogram(mapping = aes(x = sum_perday_imput))
sum_perday_imput
sum_perday <- data %>%
group_by(date) %>%
summarise(sum_perday = sum(steps, na.rm = TRUE)) %>%
mutate(Name = "Original")
sum_perday_imput <- data_imput %>%
group_by(date) %>%
summarise(sum_perday = sum(steps, na.rm = TRUE)) %>%
mutate(Name = "Imputation")
data_perday <- union(sum_perday, sum_perday_imput)
ggplot(data = data_perday) +
geom_histogram(mapping = aes(x = sum_perday)) +
facet_grid(. ~ Name)
ggplot(data = data_perday) +
geom_histogram(mapping = aes(x = sum_perday)) +
facet_grid(. ~ Name) +
labs(x = "Steps", title = "Total number of steps taken each day", subtitle = "Comparison")
ggplot(data = sum_perday) +
geom_histogram(mapping = aes(x = sum_perday)) +
labs(x = "Steps", title = "Total number of steps taken each day")
data_week <- data_imput %>%
mutate(wday = wday(date, week_start = getOption("lubridate.week.start", 1)),
type = ifelse(wday %in% c(6, 7), "weekend", "weekdays"))
library(lubridate)
data_week <- data_imput %>%
mutate(wday = wday(date, week_start = getOption("lubridate.week.start", 1)),
type = ifelse(wday %in% c(6, 7), "weekend", "weekdays"))
summary_week <- data_week %>%
group_by(interval, type) %>%
summarise(mean_steps = mean(steps, na.rm = TRUE))
summary_week
ggplot(data = data_week, mapping = aes(x = interval, y = mean_steps)) +
geom_line(colour = "red") +
labs(x = "Interval", y = "Average steps", title = "Differences in activity patterns \nbetween weekdays and weekends") +
facet_grid(. ~ type) +
theme_bw()
ggplot(data = summary_week, mapping = aes(x = interval, y = mean_steps)) +
geom_line(colour = "red") +
labs(x = "Interval", y = "Average steps", title = "Differences in activity patterns \nbetween weekdays and weekends") +
facet_grid(. ~ type) +
theme_bw()
ggplot(data = data_perday) +
geom_histogram(mapping = aes(x = sum_perday)) +
facet_grid(. ~ Name) +
labs(x = "Steps") +
labs(title = "Total number of steps taken each day") +
labs(subtitle = "Comparison") +
theme_bw()
ggplot(data = sum_perday) +
geom_histogram(mapping = aes(x = sum_perday)) +
labs(x = "Steps", title = "Total number of steps taken each day") +
theme_bw()
