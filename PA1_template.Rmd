---
title: 'Reproducible Research: Peer Assessment 1'
output:
  html_document:
    keep_md: yes
  pdf_document: default
  word_document: default
---


## Loading and preprocessing the data


Firstly I load the dataset from the zip files. 
```{r echo = TRUE}
library(readr)
data <- read_csv("activity.zip")
```

Secondly I wanted to show some first elements of this dataset to get to know something about them. Of course I used the 'summary' and 'str' function to see some basics statistics.
```{r echo = TRUE}
summary(data)
head(data)
str(data)
dim(data)
```

Now I know that this dataset have a lot of NA rows. My goal is to recognize why this value is so common. Below I show how many this NA value are. 

```{r echo = TRUE}
Percentage_NA <- length(which(is.na(data$steps)))/length(data$steps)
print(Percentage_NA)

```
The reason of so many NA values in this dataset is very simple - in that days this device didn't work or was turned off. 


## What is mean total number of steps taken per day?

```{r echo = TRUE, }
library(dplyr)

sum_perday <- data %>%
  group_by(date) %>%
  summarise(sum_perday = sum(steps, na.rm = TRUE))

mean_steps <- summarize(sum_perday, mean_perday = round(mean(sum_perday, na.rm = TRUE), 2))
```
Answer: Mean total number of steps taken per day is equal to `r mean_steps`.

## What is the average daily activity pattern?

```{r echo = TRUE}
library(ggplot2)

daily_activity <- data %>% 
  group_by(interval) %>%
  summarise(mean_steps = mean(steps, na.rm = TRUE))

ggplot(data = daily_activity, mapping = aes(x = interval, y = mean_steps)) +
  geom_line(colour = "red") +
  labs(x = "Interval", y = "Average steps", title = "Average daily activity pattern") +
  theme_bw()

```


## Imputing missing values

```{r echo = TRUE}
data_imput <- data %>%
  left_join(., daily_activity, by = c("interval")) %>%
  transform(steps = ifelse(is.na(steps), round(mean_steps, 0), steps)) %>%
  select(-mean_steps)

```

## Are there differences in activity patterns between weekdays and weekends?



```{r echo = TRUE}
library(lubridate)

data_week <- data_imput %>%
  mutate(wday = wday(date, week_start = getOption("lubridate.week.start", 1)),
         type = ifelse(wday %in% c(6, 7), "weekend", "weekdays")) %>%
  group_by(interval, type) %>%
  summarise(mean_steps = mean(steps, na.rm = TRUE))

ggplot(data = data_week, mapping = aes(x = interval, y = mean_steps)) +
  geom_line(colour = "red") +
  labs(x = "Interval", y = "Average steps", title = "Differences in activity patterns \nbetween weekdays and weekends") +
  facet_grid(. ~ type) +
  theme_bw()


```



